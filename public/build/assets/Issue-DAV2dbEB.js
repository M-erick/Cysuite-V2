import{_ as G,n as H,Q as J,r as p,q as f,g as K,i as O,j as P,A as W,o as a,a as e,l as b,c as r,b as I,s as k,t as u,F as S,u as A,d as R,h as E,w as C,v as D,e as x,p as X,f as Y}from"./app-BAfNYBvE.js";const c=_=>(X("data-v-27f2e39a"),_=_(),Y(),_),Z={class:"container mx-auto shadow-lg rounded-lg h-screen"},ee={class:"flex flex-row justify-between bg-white h-full"},se={class:"flex flex-col w-2/5 border-r-2 overflow-y-auto"},te=c(()=>e("span",{class:"text-white text-2xl",style:{"font-family":"'Roboto Serif', serif","font-style":"normal","font-weight":"400"}},"Issues",-1)),oe=c(()=>e("i",{class:"fas fa-plus-circle text-white"},null,-1)),ie=["onClick"],le={class:"w-full ml-3"},ae={class:"text-lg font-semibold",style:{"font-family":"'Roboto Serif', serif","font-style":"normal","font-weight":"500"}},ne={class:"text-gray-800",style:{"font-family":"'Roboto Serif', serif","font-style":"normal","font-weight":"400"}},re={class:"text-semibold",style:{"text-align":"right","margin-top":"0.5rem",color:"#AD9551"}},ue={style:{"text-align":"right","font-size":"0.75rem","margin-top":"0.5rem",color:"#6b7280"}},ce={class:"w-full px-5 flex flex-col justify-between"},de={key:0,class:"flex flex-col mt-5"},pe={class:"font-semibold"},fe={class:"relative mr-2 py-3 px-4 bg-green-900 rounded-bl-3xl rounded-tl-3xl rounded-tr-xl text-white"},_e={class:"absolute bottom-0 left-0 text-xs text-gray-400 transform translate-y-full"},he=["onClick"],ve=["onChange"],me=c(()=>e("option",{disabled:"",value:""}," Rate the Response ",-1)),ye=["value"],xe=c(()=>e("div",{class:"flex-grow"},null,-1)),we={key:0,class:"py-5"},ge=c(()=>e("button",{type:"submit",class:"text-white py-2 px-4 rounded mt-3"},"Submit",-1)),be={key:1,class:"flex justify-center items-center h-full"},Ie=c(()=>e("p",{class:"text-gray-500"}," Select an issue to view details ",-1)),ke=[Ie],Se={key:2,class:"py-5"},Re=c(()=>e("button",{type:"submit",class:"text-white py-2 px-4 rounded mt-3"},"Submit",-1)),Ce=c(()=>e("div",{class:"py-5"},null,-1)),De={__name:"Issue",setup(_){const i=H(),{props:F}=J(),d=F.auth.user,h=p(""),v=p("");p("");const j=p(null),m=p(""),y=p(!1),w=p(!0),U=()=>{y.value=!y.value,w.value=!w.value,y.value&&i.commit("issues/setSelectedIssue",null)},B=f(()=>i.state.issues.issues),n=f(()=>i.state.issues.selectedIssue),T=f(()=>i.state.issues.responses),g=f(()=>n.value&&n.value.status==="closed");K(()=>{i.dispatch("issues/fetchIssues")});const N=async t=>{i.commit("issues/setSelectedIssue",t),j.value=t.id,await i.dispatch("issues/fetchIssueResponses",t.id)},V=t=>{const o=new Date(t),s={hour:"numeric",minute:"numeric",day:"numeric",month:"long",year:"numeric"};return o.toLocaleString(void 0,s)},$=t=>t.id===j.value,L=async()=>{try{await x.post("/api/issues",{user_id:d.id,title:h.value,description:v.value,status:"open"}),h.value="",v.value="",await i.dispatch("issues/fetchIssues")}catch(t){console.error("Error submitting issue:",t)}},M=async()=>{try{await x.post(`/api/issues/${n.value.id}/responses`,{response_text:m.value,user_id:d.id,issue_id:n.value.id}),m.value="",await i.dispatch("issues/fetchIssueResponses",n.value.id)}catch(t){console.error("Error submitting response:",t)}},z=f(()=>B.value.filter(t=>t.user_id===d.id)),q=async t=>{try{await x.put(`/api/issues/${n.value.id}`,{user_id:d.id,title:n.value.title,description:n.value.description,status:"closed"}),await i.dispatch("issues/fetchIssues"),await i.dispatch("issues/fetchIssueResponses",n.value.id)}catch(o){console.error("Error marking issue as resolved:",o)}},Q=async(t,o)=>{const s=T.value.find(l=>l.id===o);if(!s){console.error("Response not found");return}try{await x.post("/api/ratings",{user_id:d.id,rated_user_id:s.user_id,rating:t})}catch(l){console.error("Error rating response:",l)}};return(t,o)=>(a(),O(W,null,{default:P(()=>[e("div",Z,[e("div",ee,[e("div",se,[e("div",{class:"border-b-2 py-4 px-2 flex justify-between",style:{"background-color":"#AD9551"}},[te,e("span",{onClick:U,class:"cursor-pointer text-white",style:{"font-family":"'Roboto Serif', serif","font-style":"normal","font-weight":"400"}},[b(" Create Issue "),oe])]),(a(!0),r(S,null,I(z.value,s=>(a(),r("div",{key:s.id,class:k(["flex flex-row py-4 px-2 items-center border-b-2 cursor-pointer",{"selected-issue  ":$(s)}]),onClick:l=>N(s)},[e("div",le,[e("div",ae,u(s.title),1),e("div",ne,u(s.description),1),e("div",re,u(s.status),1),e("div",ue,u(V(s.created_at)),1)])],10,ie))),128))]),e("div",ce,[n.value?(a(),r("div",de,[(a(!0),r(S,null,I(T.value,s=>(a(),r("div",{key:s.id,class:k([{"justify-end":s.user_id===A(d).id,"justify-start":s.user_id!==A(d).id},"flex mb-4"])},[e("span",null,[b("@UserID::"),e("span",pe,u(s.user_id),1)]),e("div",fe,[b(u(s.response_text)+" ",1),e("span",_e,u(V(s.created_at)),1)]),e("i",{class:k(["fa-solid fa-check text-white py-2 px-4 rounded-bl-3xl rounded-tl-3xl rounded-tr-xl m-3",{"bg-green-900":!g.value,"bg-gray-500":g.value}]),onClick:l=>q(s.id)},null,10,he),g.value?R("",!0):(a(),r("select",{key:0,onChange:l=>Q(l.target.value,s.id)},[me,(a(),r(S,null,I(5,l=>e("option",{key:l,value:l},u(l),9,ye)),64))],40,ve))],2))),128)),xe,w.value?(a(),r("div",we,[e("form",{onSubmit:E(M,["prevent"])},[C(e("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),class:"w-full bg-white py-5 px-3 rounded-xl",type:"text",placeholder:"Type your message here..."},null,512),[[D,m.value]]),ge],32)])):R("",!0)])):(a(),r("div",be,ke)),y.value?(a(),r("div",Se,[e("form",{onSubmit:E(L,["prevent"])},[C(e("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>h.value=s),class:"bg-white py-5 px-3 rounded-xl",type:"text",placeholder:"Title"},null,512),[[D,h.value]]),C(e("input",{"onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),class:"w-full bg-white py-5 px-3 rounded-xl mt-2",type:"text",placeholder:"Description"},null,512),[[D,v.value]]),Re],32)])):R("",!0),Ce])])])]),_:1}))}},Te=G(De,[["__scopeId","data-v-27f2e39a"]]);export{Te as default};
